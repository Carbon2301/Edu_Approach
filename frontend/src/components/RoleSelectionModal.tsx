import { useState } from 'react';import { useNavigate } from 'react-router-dom';import { useLanguage } from '../contexts/LanguageContext';import { useToastMessage } from '../contexts/ToastContext';import { api } from '../services/api';interface RoleSelectionModalProps {  isOpen: boolean;  onClose: () => void;}const RoleSelectionModal = ({ isOpen, onClose }: RoleSelectionModalProps) => {  const navigate = useNavigate();  const { t, language } = useLanguage();  const toast = useToastMessage();  const [role, setRole] = useState<'student' | 'teacher'>('student');  const [studentId, setStudentId] = useState('');  const [errors, setErrors] = useState<{ [key: string]: string }>({});  const [isLoading, setIsLoading] = useState(false);  if (!isOpen) return null;  const handleSubmit = async (e: React.FormEvent) => {    e.preventDefault();    setErrors({});    if (role === 'student' && !studentId.trim()) {      setErrors({ studentId: language === 'ja' ? '学生IDが必要です' : 'Vui lòng nhập MSSV' });      return;    }    setIsLoading(true);    try {      const result = await api.completeGoogleRegistration({        role,        studentId: role === 'student' ? studentId.trim() : undefined,      });      if (result.success) {        toast.success('registrationCompleted');        setTimeout(() => {          if (role === 'teacher') {            navigate('/teacher/home');          } else {            navigate('/dashboard');          }        }, 1500);      } else {        setErrors({ submit: result.message || t('registrationFailed') });      }    } catch (error: any) {      setErrors({ submit: error.message || t('registrationFailed') });    } finally {      setIsLoading(false);    }  };  return (    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">      <div className="bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4 border-2 border-gray-900">        <h2 className="text-2xl font-bold text-gray-900 mb-4 text-center">          {language === 'ja' ? '役割を選択' : 'Chọn vai trò của bạn'}        </h2>        <p className="text-gray-600 mb-6 text-center">          {language === 'ja'             ? 'アカウント登録を完了するには、役割を選択してください'             : 'Vui lòng chọn vai trò để hoàn tất đăng ký'}        </p>        <form onSubmit={handleSubmit} className="space-y-4">          {}          <div>            <label className="block text-sm font-medium text-gray-700 mb-3">              {t('userRole')} <span className="text-red-500">*</span>            </label>            <div className="flex gap-4">              <label className="flex items-center cursor-pointer">                <input                  type="radio"                  name="role"                  value="student"                  checked={role === 'student'}                  onChange={(e) => {                    setRole(e.target.value as 'student' | 'teacher');                    setErrors({});                  }}                  className="w-4 h-4 text-gray-900 focus:ring-gray-900 border-gray-300"                />                <span className="ml-2 text-sm text-gray-700">{t('student')}</span>              </label>              <label className="flex items-center cursor-pointer">                <input                  type="radio"                  name="role"                  value="teacher"                  checked={role === 'teacher'}                  onChange={(e) => {                    setRole(e.target.value as 'student' | 'teacher');                    setErrors({});                  }}                  className="w-4 h-4 text-gray-900 focus:ring-gray-900 border-gray-300"                />                <span className="ml-2 text-sm text-gray-700">{t('teacher')}</span>              </label>            </div>          </div>          {}          {role === 'student' && (            <div>              <label className="block text-sm font-medium text-gray-700 mb-1">                {t('studentId')} <span className="text-red-500">*</span>              </label>              <input                type="text"                value={studentId}                onChange={(e) => {                  setStudentId(e.target.value);                  if (errors.studentId) {                    setErrors({ ...errors, studentId: '' });                  }                }}                placeholder={language === 'ja' ? '学生IDを入力' : 'Nhập MSSV'}                className={`input-field ${errors.studentId ? 'border-red-500' : ''}`}              />              {errors.studentId && (                <p className="mt-1 text-sm text-red-600">{errors.studentId}</p>              )}            </div>          )}          {}          {errors.submit && (            <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded">              {errors.submit}            </div>          )}          {}          <div className="flex gap-3 mt-6">            <button              type="button"              onClick={onClose}              className="flex-1 px-4 py-2 border-2 border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors"              disabled={isLoading}            >              {language === 'ja' ? 'キャンセル' : 'Hủy'}            </button>            <button              type="submit"              className="flex-1 btn-primary"              disabled={isLoading}            >              {isLoading                 ? (language === 'ja' ? '処理中...' : 'Đang xử lý...')                 : (language === 'ja' ? '登録完了' : 'Hoàn tất')}            </button>          </div>        </form>      </div>    </div>  );};export default RoleSelectionModal;