import { useEffect, useState } from 'react';import { useNavigate } from 'react-router-dom';import { BookOpen, User } from 'lucide-react';import { useLanguage } from '../contexts/LanguageContext';import LanguageSelector from '../components/LanguageSelector';import Logo from '../components/Logo';import AIRecommendations from '../components/AIRecommendations';import { quizApi } from '../services/quizApi';import { api } from '../services/api';import { translateQuiz } from '../utils/translateQuizData';const StudentDashboard = () => {  const navigate = useNavigate();  const { t, language } = useLanguage();  const [quizzes, setQuizzes] = useState<any[]>([]);  const [user, setUser] = useState<any>(null);  const [isLoading, setIsLoading] = useState(true);  const [dashboardData, setDashboardData] = useState<any>(null);  useEffect(() => {    loadData();  }, []);  const loadData = async () => {    setIsLoading(true);    try {      const userResult = await api.getCurrentUser();      if (userResult.success && userResult.data) {        setUser(userResult.data.user);      }      const quizzesResult = await quizApi.getAllQuizzes();      if (quizzesResult.success && quizzesResult.data) {        setQuizzes(quizzesResult.data.quizzes);      }      const dashboardResult = await api.getStudentDashboard();      if (dashboardResult.success && dashboardResult.data) {        setDashboardData(dashboardResult.data);      }    } catch (error) {      console.error('Load data error:', error);    } finally {      setIsLoading(false);    }  };  const handleViewAllQuizzes = () => {    navigate('/quizzes');  };  const handleStartQuiz = (quizId: string) => {    navigate(`/quiz/${quizId}`);  };  if (isLoading) {    return (      <div className="min-h-screen bg-gray-50 flex items-center justify-center">        <div className="text-center">          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"></div>          <p className="mt-4 text-gray-600">Loading...</p>        </div>      </div>    );  }  return (    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50">      {}      <div className="fixed left-0 top-0 bottom-0 w-64 bg-white border-r-2 border-gray-900 flex flex-col z-10">        {}        <div className="px-6 py-6">          <Logo size={40} showText={true} />        </div>        {}        <div className="flex-1" />        {}        {user && (          <div             onClick={() => navigate('/profile')}            className="cursor-pointer hover:bg-gray-100 p-3 mx-4 mb-4 transition-colors"          >            <div className="flex items-center gap-3">              {user.profileImage ? (                <img                  src={user.profileImage}                  alt="Profile"                  className="w-12 h-12 rounded-full object-cover border-2 border-gray-900 flex-shrink-0"                />              ) : (                <div className="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-gray-900 flex-shrink-0">                  <User size={24} className="text-gray-400" />                </div>              )}              <div className="flex-1 min-w-0">                <p className="font-bold text-gray-900 text-sm truncate">                  {user.name}                </p>                <p className="text-xs text-gray-600 truncate">                  {user.email}                </p>              </div>            </div>          </div>        )}            </div>      {}      <div className="ml-64">        {}        <header className="bg-white border-b border-gray-200 shadow-sm">          <div className="container mx-auto px-4 py-4">            <div className="flex justify-end items-center">            <div className="flex items-center gap-4">              <LanguageSelector />              <button                onClick={handleViewAllQuizzes}                className="px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors flex items-center gap-2"              >                <BookOpen size={20} />                <span className="hidden md:inline">{t('allQuizzes')}</span>              </button>            </div>          </div>        </div>      </header>      {}      <main className="container mx-auto px-4 py-12">        <div className="max-w-5xl mx-auto">          {}          <div className="mb-8">            <h1 className="text-4xl font-bold text-gray-900 mb-2">              {t('welcome')}, {user?.name || t('student')}!            </h1>            <p className="text-gray-600">              {t('dashboardDescription')}            </p>          </div>          <div>            {}            <div>              <div className="bg-white rounded-2xl shadow-lg p-8 border-2 border-gray-200">                <h2 className="text-2xl font-bold text-gray-900 mb-6">                  {language === 'ja' ? 'Áµ±Ë®à„Éó„É≠„Éï„Ç£„Éº„É´' : 'Th·ªëng k√™ h·ªì s∆°'}                </h2>                <div className="space-y-6">                  {}                  <div className="grid grid-cols-2 gap-4 mb-6">                    <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 border-2 border-blue-200">                      <div className="flex items-center gap-3 mb-2">                        <div className="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">                          <BookOpen size={20} className="text-white" />                        </div>                        <div>                          <p className="text-sm text-gray-600">                            {language === 'ja' ? 'ÂÆå‰∫Ü„Åó„Åü„ÇØ„Ç§„Ç∫' : 'B√†i ki·ªÉm tra ho√†n th√†nh'}                          </p>                          <p className="text-3xl font-bold text-gray-900">                            {dashboardData?.completedQuizzes || 0}                          </p>                        </div>                      </div>                    </div>                    <div className="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 border-2 border-purple-200">                      <div className="flex items-center gap-3 mb-2">                        <div className="w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center">                          <span className="text-white text-xl">üìä</span>                        </div>                        <div>                          <p className="text-sm text-gray-600">                            {language === 'ja' ? 'Âà©Áî®ÂèØËÉΩ„Å™„ÇØ„Ç§„Ç∫' : 'B√†i ki·ªÉm tra kh·∫£ d·ª•ng'}                          </p>                          <p className="text-3xl font-bold text-gray-900">                            {quizzes.length}                          </p>                        </div>                      </div>                    </div>                  </div>                  {}                  {dashboardData?.studentClassification && (                    <div className="bg-gradient-to-br from-green-50 to-emerald-100 rounded-lg p-6 border-2 border-green-200 mb-6">                      <div className="flex items-center gap-3 mb-2">                        <div className="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center">                          <User size={20} className="text-white" />                        </div>                        <div className="flex-1">                          <p className="text-sm text-gray-600 mb-1">                            {language === 'ja' ? '„ÅÇ„Å™„Åü„ÅÆ„Çø„Ç§„Éó' : 'Lo·∫°i h·ªçc sinh c·ªßa b·∫°n'}                          </p>                          <p className="text-2xl font-bold text-gray-900">                            {dashboardData.studentClassification.name[language]}                          </p>                        </div>                      </div>                    </div>                  )}                  {}                  <div>                    <AIRecommendations />                  </div>                </div>              </div>            </div>          </div>        </div>      </main>      </div>    </div>  );};export default StudentDashboard;