import { useEffect, useState } from 'react';import { useNavigate } from 'react-router-dom';import { ArrowLeft, BookOpen, User } from 'lucide-react';import { useLanguage } from '../contexts/LanguageContext';import LanguageSelector from '../components/LanguageSelector';import Logo from '../components/Logo';import { quizApi } from '../services/quizApi';import { api } from '../services/api';import { translateQuiz } from '../utils/translateQuizData';const QuizList = () => {  const navigate = useNavigate();  const { t, language } = useLanguage();  const [quizzes, setQuizzes] = useState<any[]>([]);  const [user, setUser] = useState<any>(null);  const [isLoading, setIsLoading] = useState(true);  useEffect(() => {    loadData();  }, []);  const loadData = async () => {    setIsLoading(true);    try {      const userResult = await api.getCurrentUser();      if (userResult.success && userResult.data) {        setUser(userResult.data.user);      }      const quizzesResult = await quizApi.getAllQuizzes();      if (quizzesResult.success && quizzesResult.data) {        setQuizzes(quizzesResult.data.quizzes);      }    } catch (error) {      console.error('Load data error:', error);    } finally {      setIsLoading(false);    }  };  const handleStartQuiz = (quizId: string) => {    navigate(`/quiz/${quizId}`);  };  const handleViewResult = (quizId: string) => {    navigate(`/quiz/${quizId}/result`);  };  if (isLoading) {    return (      <div className="min-h-screen bg-gray-50 flex items-center justify-center">        <div className="text-center">          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"></div>          <p className="mt-4 text-gray-600">Loading...</p>        </div>      </div>    );  }  return (    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50">      {}      <div className="fixed left-0 top-0 bottom-0 w-64 bg-white border-r-2 border-gray-900 flex flex-col z-10">        {}        <div className="px-6 py-6">          <Logo size={40} showText={true} />        </div>        {}        <div className="px-6 mb-4">          <button            onClick={() => navigate('/dashboard')}            className="w-full flex items-center gap-2 px-4 py-2 hover:bg-gray-100 rounded-md transition-colors"          >            <ArrowLeft size={20} className="text-gray-900" />            <span className="text-sm font-medium text-gray-900">{t('backToDashboard')}</span>          </button>        </div>        {}        <div className="flex-1" />        {}        {user && (          <div             onClick={() => navigate('/profile')}            className="cursor-pointer hover:bg-gray-100 p-3 mx-4 mb-4 transition-colors"          >            <div className="flex items-center gap-3">              {user.profileImage ? (                <img                  src={user.profileImage}                  alt="Profile"                  className="w-12 h-12 rounded-full object-cover border-2 border-gray-900 flex-shrink-0"                />              ) : (                <div className="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-gray-900 flex-shrink-0">                  <User size={24} className="text-gray-400" />                </div>              )}              <div className="flex-1 min-w-0">                <p className="font-bold text-gray-900 text-sm truncate">                  {user.name}                </p>                <p className="text-xs text-gray-600 truncate">                  {user.email}                </p>              </div>            </div>          </div>        )}      </div>      {}      <div className="ml-64">        {}        <header className="bg-white border-b border-gray-200 shadow-sm">          <div className="container mx-auto px-4 py-4">            <div className="flex justify-end items-center">              <LanguageSelector />            </div>          </div>        </header>        {}        <main className="container mx-auto px-4 py-8">        <div className="max-w-5xl mx-auto">          {}          <div className="bg-gradient-to-r from-gray-900 to-gray-700 text-white rounded-lg p-8 mb-8 shadow-lg">            <h1 className="text-3xl font-bold mb-2">{t('allQuizSets')}</h1>            <p className="text-gray-200">{t('allQuizSetsDescription')}</p>          </div>          {}          <div className="grid gap-6">            {quizzes.length === 0 ? (              <div className="bg-white rounded-lg p-12 text-center border-2 border-gray-200">                <BookOpen size={64} className="mx-auto text-gray-300 mb-4" />                <p className="text-gray-500 text-lg">{t('noQuizzes')}</p>              </div>            ) : (              quizzes.map((quiz) => {                const translatedQuiz = translateQuiz(quiz, language);                return (                <div                  key={quiz._id}                  className="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200 hover:border-gray-900 transition-all"                >                  <div className="flex justify-between items-start">                    <div className="flex-1">                      <h2 className="text-xl font-bold text-gray-900 mb-2">                        {translatedQuiz.title}                      </h2>                      <p className="text-gray-600 mb-3 text-sm">{translatedQuiz.description}</p>                      <div className="flex items-center gap-4 text-xs text-gray-500 mb-3">                        <span className="flex items-center gap-1">                          <BookOpen size={14} />                          {quiz.totalQuestions} {t('questions')}                        </span>                        {quiz.timeLimitMinutes && (                          <span className="flex items-center gap-1">                            ⏱️ {quiz.timeLimitMinutes} {t('minutes')}                          </span>                        )}                      </div>                      <div className="flex items-center gap-3">                        <span                          className={`px-3 py-1 rounded-full text-xs font-medium ${                            quiz.isCompleted                              ? 'bg-green-100 text-green-800'                              : 'bg-yellow-100 text-yellow-800'                          }`}                        >                          {quiz.isCompleted ? `✓ ${t('completed')}` : t('notCompleted')}                        </span>                        {quiz.isCompleted && quiz.lastCompletedAt && (                          <span className="text-xs text-gray-500">                            {new Date(quiz.lastCompletedAt).toLocaleDateString()}                          </span>                        )}                      </div>                    </div>                    <div className="ml-4 flex flex-col gap-2">                      {quiz.isCompleted ? (                        <>                          <button                            onClick={(e) => { e.stopPropagation(); handleViewResult(quiz._id); }}                            className="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition-colors whitespace-nowrap"                          >                            {t('viewResult')}                          </button>                          <button                            onClick={(e) => { e.stopPropagation(); handleStartQuiz(quiz._id); }}                            className="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-300 transition-colors whitespace-nowrap"                          >                            {t('retake')}                          </button>                        </>                      ) : (                        <button                          onClick={(e) => { e.stopPropagation(); handleStartQuiz(quiz._id); }}                          className="px-4 py-2 bg-gray-900 text-white rounded-lg text-sm font-semibold hover:bg-gray-800 transition-colors whitespace-nowrap"                        >                          {t('takeQuiz')} →                        </button>                      )}                    </div>                  </div>                </div>              )})            )}          </div>        </div>      </main>      </div>    </div>  );};export default QuizList;