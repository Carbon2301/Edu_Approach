import { Strategy as GoogleStrategy } from 'passport-google-oauth20';import User from '../models/User.model.js';export const configurePassport = (passport) => {  passport.use(    new GoogleStrategy(      {        clientID: process.env.GOOGLE_CLIENT_ID,        clientSecret: process.env.GOOGLE_CLIENT_SECRET,        callbackURL: process.env.GOOGLE_CALLBACK_URL,      },      async (accessToken, refreshToken, profile, done) => {        try {          let user = await User.findOne({ googleId: profile.id });          if (user) {            user.lastLogin = new Date();            await user.save();            return done(null, user);          }          user = await User.findOne({ email: profile.emails[0].value });          if (user) {            user.googleId = profile.id;            user.isEmailVerified = true;            user.lastLogin = new Date();            if (!user.profileImage && profile.photos && profile.photos.length > 0) {              user.profileImage = profile.photos[0].value;            }            await user.save();            return done(null, user);          }          const pendingUser = {            googleId: profile.id,            email: profile.emails[0].value,            name: profile.displayName,            profileImage: profile.photos && profile.photos.length > 0 ? profile.photos[0].value : null,            isEmailVerified: true,          };          return done(null, { ...pendingUser, isPending: true });        } catch (error) {          done(error, null);        }      }    )  );  passport.serializeUser((user, done) => {    if (user.isPending) {      done(null, { isPending: true, ...user });    } else {    done(null, user.id);    }  });  passport.deserializeUser(async (idOrUser, done) => {    try {      if (idOrUser && typeof idOrUser === 'object' && idOrUser.isPending) {        return done(null, idOrUser);      }      const user = await User.findById(idOrUser);      done(null, user);    } catch (error) {      done(error, null);    }  });};