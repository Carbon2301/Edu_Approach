import express from 'express';import cors from 'cors';import helmet from 'helmet';import dotenv from 'dotenv';import session from 'express-session';import passport from 'passport';import { fileURLToPath } from 'url';import { dirname, join } from 'path';import connectDB from './config/database.js';import { configurePassport } from './config/passport.js';import authRoutes from './routes/auth.routes.js';import userRoutes from './routes/user.routes.js';import quizRoutes from './routes/quiz.routes.js';import aiRoutes from './routes/ai.routes.js';import classRoutes from './routes/class.routes.js';import { errorHandler } from './middleware/errorHandler.js';const __filename = fileURLToPath(import.meta.url);const __dirname = dirname(__filename);const backendRoot = join(__dirname, '..');const uploadsPath = join(backendRoot, 'uploads');const envPath = join(backendRoot, '.env');dotenv.config({ path: envPath });if (!process.env.GEMINI_API_KEY) {  console.warn('тЪая╕П  WARNING: GEMINI_API_KEY is not set! AI features will not work.');  console.warn('   Please check backend/.env file and restart the server.');}const app = express();connectDB();configurePassport(passport);app.use(helmet({  crossOriginResourcePolicy: { policy: "cross-origin" },  contentSecurityPolicy: false, 
}));app.use(cors({  origin: process.env.CLIENT_URL || 'http://localhost:5173',  credentials: true,}));app.use(express.json());app.use(express.urlencoded({ extended: true }));app.use(  session({    secret: process.env.SESSION_SECRET || process.env.JWT_SECRET || 'your-secret-key',    resave: false,    saveUninitialized: false,    cookie: {      secure: process.env.NODE_ENV === 'production',      httpOnly: true,      maxAge: 24 * 60 * 60 * 1000, 
    },  }));app.use(passport.initialize());app.use(passport.session());app.use('/uploads', express.static(uploadsPath));app.use('/api/auth', authRoutes);app.use('/api/users', userRoutes);app.use('/api/quizzes', quizRoutes);app.use('/api/ai', aiRoutes);app.use('/api/classes', classRoutes);app.get('/api/health', (req, res) => {  res.json({ status: 'OK', message: 'EduApproach API is running' });});app.use(errorHandler);const PORT = process.env.PORT || 5000;app.listen(PORT, () => {  console.log(`ЁЯЪА Server running on port ${PORT} in ${process.env.NODE_ENV} mode`);});